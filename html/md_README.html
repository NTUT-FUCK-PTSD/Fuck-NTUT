<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Crypt of the NecroDancer: Crypt of the NecroDancer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Crypt of the NecroDancer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Crypt of the NecroDancer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><b>這是期末報告的md版本，此外Release中有編譯好的Windows版本可以直接執行</b></li>
</ul>
<p><b>國立臺北科技大學 2024 資工系物件導向程式設計實習期末報告</b></p>
<p><b>第 P03 組</b></p>
<ul>
<li>111590028 張睿恩</li>
<li>111590009 陳世昂</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
目錄</h1>
<ul>
<li><a href="#專案簡介">專案簡介</a><ul>
<li><a href="#遊戲簡介">遊戲簡介</a></li>
<li><a href="#組別分工">組別分工</a></li>
</ul>
</li>
<li><a href="#遊戲介紹">遊戲介紹</a><ul>
<li><a href="#遊戲規則">遊戲規則</a></li>
<li><a href="#遊戲畫面">遊戲畫面</a></li>
</ul>
</li>
<li><a href="#程式設計">程式設計</a><ul>
<li><a href="#程式架構">程式架構</a></li>
<li><a href="#程式技術">程式技術</a></li>
</ul>
</li>
<li><a href="#結語">結語</a><ul>
<li><a href="#問題及解決方法">問題及解決方法</a></li>
<li><a href="#貢獻比例">貢獻比例</a></li>
<li><a href="#自我檢核表">自我檢核表</a></li>
<li><a href="#收穫">收穫</a></li>
<li><a href="#心得感想">心得、感想</a></li>
<li><a href="#對於本課程的建議">對於本課程的建議</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
專案簡介</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
遊戲簡介</h2>
<p>Crypt of the NecroDancer 是一款結合 Rogue-like 和音樂遊戲元素的遊戲。玩家需要在隨機生成的地下城中，跟隨音樂節奏來移動和戰鬥。這款遊戲的獨特之處在於，玩家的所有動作都必須跟隨音樂的節奏，這不僅增加了遊戲的挑戰性，還讓遊戲充滿了音樂的樂趣。</p>
<p>遊戲的原版包含四個主要區域，每個區域都有其獨特的地圖生成機率和 Boss 強度。此外，DLC 版本還添加了一個額外的區域。在本專案中，我們實現了其中一個區域，確保了遊戲的核心玩法得以呈現。</p>
<h2><a class="anchor" id="autotoc_md5"></a>
組別分工</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">學號/姓名   </th><th class="markdownTableHeadNone">負責項目    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">111590028 張睿恩   </td><td class="markdownTableBodyNone">地圖讀取、Tiles 和 Enemy 產生    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">111590009 陳世昂   </td><td class="markdownTableBodyNone">音樂節奏處理、UI 控制   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md6"></a>
遊戲介紹</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
遊戲規則</h2>
<p>在 Crypt of the NecroDancer 中，玩家的主要目標是到達下一關。由於遊戲過程中無法回復生命值，玩家需要在不受傷的情況下盡量前進。在每一關的最後，玩家需要擊敗 miniBoss 才能開啟前往下一關的樓梯。</p>
<p>我們在本次專案中實現了 Zone1 的三個關卡（Zone1_1、Zone1_2、Zone1_3），以及 Zone1 的 Boss 關卡 King Conga。King Conga 是一個非常有特色的 Boss，具備獨特的攻擊模式和挑戰性。</p>
<h2><a class="anchor" id="autotoc_md8"></a>
遊戲畫面</h2>
<p>以下是遊戲的一些主要功能鍵說明，包含了常規操作和 Debug 用的按鍵：</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">按鍵   </th><th class="markdownTableHeadNone">功能    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">WASD   </td><td class="markdownTableBodyNone">控制角色操作    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Esc   </td><td class="markdownTableBodyNone">退出遊戲    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">R   </td><td class="markdownTableBodyNone">重新開始遊戲    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Debug Mode</b>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">B   </td><td class="markdownTableBodyNone">前往 Boss 關卡    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">I   </td><td class="markdownTableBodyNone">無敵模式    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">M   </td><td class="markdownTableBodyNone">無節奏模式（太快會導致畫面卡頓，但功能正常）<br  />
備註:會暫停全域 Tempo 更新    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">N   </td><td class="markdownTableBodyNone">前往下一關卡    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">O   </td><td class="markdownTableBodyNone">一拳超人模式（攻擊力 999）   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md9"></a>
程式設計</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
程式架構</h2>
<ul>
<li>程式架構介紹的內容可以在這裡補充，說明整個程式的模組劃分和主要的程式流。</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
程式技術</h2>
<p>在這次實作中學習與研究到了許多技術，讓這個遊戲的開發更加順利，以下是我們一些重要的技術：</p>
<h3><a class="anchor" id="autotoc_md12"></a>
事件處理(Event)</h3>
<p>由於我們的遊戲中擁有大量的互動事件，例如怪物攻擊玩家、玩家攻擊怪物、玩家移動、節奏移動等事件，這些事件往往需要雙方進行控制。我們採用了一個事件庫來處理這類事件，這樣可以減少程式的相互依賴性，提高可讀性及可維護性。</p>
<h3><a class="anchor" id="autotoc_md13"></a>
路徑搜尋(A*演算法)</h3>
<p>在怪物搜尋路徑的地方，我們採用 A* 演算法完成，因為 A* 是在這裡最適合我們的演算法之一，並且有著不錯的效率。</p>
<h3><a class="anchor" id="autotoc_md14"></a>
視野計算(布雷森漢姆直線演算法)</h3>
<p>在視野的處理上，我們使用了 Bresenham's line algorithm，因為我們的視野是以一個方格去處理，因此使用這個演算法的優勢在於我們不需要使用浮點計算，只需要用到整數加法、減法。</p>
<h3><a class="anchor" id="autotoc_md15"></a>
XML 地圖讀取(反序列化)</h3>
<p>這個 XML 檔相容於原版遊戲中的地圖，主要操作是將 XML 檔先進行反序列化，接著再進行每個 level 的物件生成。在這過程中，因為 XML 檔會丟失一些細節，我們需要補上，例如地圖邊界、地圖大小，我們需要在讀取時額外加入這些部分。</p>
<h3><a class="anchor" id="autotoc_md16"></a>
怪物優先級(Priority)</h3>
<p>由於我們這款遊戲是根據節奏為中心，因此我們必須決定怪物在每次節奏的優先級。目前我們的算法是先計算怪物自身的優先度，從血量、攻擊、金幣及隱藏的優先度進行第一次優先度檢查，而當以上均相等時，我們進行第二次優先度判斷，根據距離玩家的距離進行怪物的更新。</p>
<p>我們不是使用 priority queue，因為我們在每個 tempo 都需要進行優先度調整，而使用 priority queue 需要建立新的 priority queue，這樣改動會較大，因此我們選擇對 vector 做 sort。</p>
<h1><a class="anchor" id="autotoc_md17"></a>
結語</h1>
<h2><a class="anchor" id="autotoc_md18"></a>
問題及解決方法</h2>
<p>在這次實作中我們遇到了很多問題：</p>
<ol type="1">
<li>**音樂的問題**：我們需要取得音樂的時間來產生對應的節奏，原版的 PTSD 中無法簡單完成這件事，所以我們改用了外部的音樂庫。</li>
<li>**性能問題**：在進行怪物、地圖更新時，我們一直關注性能優化，使用了多種計算方式，目前的方式在能接受的性能下是最好的解決方案，特別是在處理視野的部分。</li>
<li>**互動事件處理**：在每個節奏中處理不同的事件時常遇到問題，我們採用事件庫來提高處理的效率和準確性。</li>
</ol>
<h2><a class="anchor" id="autotoc_md19"></a>
貢獻比例</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">學號/姓名   </th><th class="markdownTableHeadNone">貢獻比例    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">111590028 張睿恩   </td><td class="markdownTableBodyNone">50%    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">111590009 陳世昂   </td><td class="markdownTableBodyNone">50%   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md20"></a>
自我檢核表</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">項目   </th><th class="markdownTableHeadNone">完成    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">完成協議書上所描述的最小關卡數量   </td><td class="markdownTableBodyNone">V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">完成專案權限改為 public   </td><td class="markdownTableBodyNone">V    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">具有 debug mode 的功能   </td><td class="markdownTableBodyNone">V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">解決專案上所有 Memory Leak 的問題   </td><td class="markdownTableBodyNone">V    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">報告中沒有任何錯字，以及沒有任何一項遺漏   </td><td class="markdownTableBodyNone">V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">報告至少保持基本的美感，人類可讀   </td><td class="markdownTableBodyNone">V   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md21"></a>
收穫</h2>
<p>這堂課對我而言最大的收穫在於如何使用 C++ 完成一個遊戲專案，並讓我認識到了與別人共同開發專案會面臨的問題。在這過程中，我們會有一些盲點，透過討論也能增進我們的程式技巧。此外，在開發這次專案的過程中，讓我掌握了很多新的技巧，特別是 Github、CMake 及演算法在實際專案中的應用。</p>
<h2><a class="anchor" id="autotoc_md22"></a>
心得、感想</h2>
<p>這次遊戲開發讓我認識到了自己的不足之處，例如該如何處理多人專案。在此之前我對這了解甚少，在這次之後我對於這方面的能力有了些許增強。但這次專案有個遺憾之處，就是由於時間有限，有些功能無法完全呈現，但我們已經盡力做到最好，希望這款遊戲能給予玩家好的遊戲體驗。</p>
<h2><a class="anchor" id="autotoc_md23"></a>
對於本課程的建議</h2>
<p>沒有，謝謝老師。 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
